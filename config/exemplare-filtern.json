[
    {
      "op": "core/multivalued-cell-join",
      "columnName": "item_id_mv",
      "keyColumnName": "id",
      "separator": ",",
      "description": "Join multi-valued cells in column item_id_mv"
    },
    {
      "op": "core/text-transform",
      "engineConfig": {
        "facets": [],
        "mode": "row-based"
      },
      "columnName": "item_id_mv",
      "expression": "grel:filter(value.split(','), v, isNonBlank(v.cross('exemplare', 'id'))).join(',')",
      "onError": "keep-original",
      "repeat": false,
      "repeatCount": 10,
      "description": "Text transform on cells in column item_id_mv using expression grel:filter(value.split(','), v, isNonBlank(v.cross('exemplare', 'id'))).join(',')"
    },
    {
      "op": "core/multivalued-cell-split",
      "columnName": "item_id_mv",
      "keyColumnName": "id",
      "mode": "separator",
      "separator": ",",
      "regex": false,
      "description": "Split multi-valued cells in column item_id_mv"
    },
    {
      "op": "core/column-removal",
      "columnName": "item_holding_display_mv",
      "description": "Remove column item_holding_display_mv"
    },
    {
      "op": "core/column-removal",
      "columnName": "item_holding_id_mv",
      "description": "Remove column item_holding_id_mv"
    },
    {
      "op": "core/row-removal",
      "engineConfig": {
        "facets": [
          {
            "type": "list",
            "name": "Blank Rows",
            "expression": "(filter(row.columnNames,cn,isNonBlank(cells[cn].value)).length()==0).toString()",
            "columnName": "",
            "invert": false,
            "omitBlank": false,
            "omitError": false,
            "selection": [
              {
                "v": {
                  "v": "true",
                  "l": "true"
                }
              }
            ],
            "selectBlank": false,
            "selectError": false
          }
        ],
        "mode": "row-based"
      },
      "description": "Remove rows"
    }
  ]
